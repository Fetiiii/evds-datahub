# EVDS DataHub

[![GÃ¼nlÃ¼k EVDS Veri GÃ¼ncelleme](https://github.com/Fetiiii/evds-datahub/actions/workflows/data_update.yml/badge.svg)](../../actions/workflows/data_update.yml)

TCMB **EVDS** veritabanÄ±ndaki binlerce ekonomik seriyi **otomatik Ã§eken, dÃ¼zenleyen ve gÃ¼ncel tutan** aÃ§Ä±k kaynaklÄ± bir veri pipeline projesi.

## âœ¨ Ã–zellikler

- âš™ï¸ **Tam otomatik:** GitHub Actions ile periyodik gÃ¼ncelleme
- ğŸ’¾ **DÃ¼zenli klasÃ¶r yapÄ±sÄ±:** Ana kategori â†’ Alt kategori â†’ Seri (CSV)
- ğŸ” **AkÄ±llÄ± gÃ¼ncelleme:** Var olan CSV'leri atlayarak kaldÄ±ÄŸÄ± yerden devam
- ğŸ§± **SaÄŸlam altyapÄ±:** BaÄŸlantÄ± hatalarÄ±nda otomatik retry ve detaylÄ± loglama
- ğŸš€ **Kolay entegrasyon:** ML/analiz projeleri iÃ§in hazÄ±r veri kaynaÄŸÄ±

> ğŸ’¡ Bu repo yalnÄ±zca **veri Ã§ekimi ve otomasyon** iÃ§in tasarlanmÄ±ÅŸtÄ±r.

---

## ğŸ“¦ Ä°Ã§indekiler

- [Kurulum](#-kurulum)
- [KullanÄ±m](#-kullanÄ±m)
  - [Tam Ã‡ekim](#-tam-Ã§ekim-ilk-kurulum)
  - [GÃ¼ncelleme Modu](#-gÃ¼ncelleme-modu)
- [Workflow (Otomasyon)](#-workflow-otomasyon)
- [KlasÃ¶r YapÄ±sÄ±](#ï¸-klasÃ¶r-yapÄ±sÄ±)
- [Loglama](#-loglama)
- [Sorun Giderme](#-sorun-giderme)
- [Lisans](#-lisans)

---

## âš™ï¸ Kurulum

### 1ï¸âƒ£ BaÄŸÄ±mlÄ±lÄ±klarÄ± YÃ¼kleyin

```bash
pip install -r requirements.txt
```

### 2ï¸âƒ£ API AnahtarÄ±nÄ± AyarlayÄ±n

#### Lokal Ortam

`.env` dosyasÄ± oluÅŸturun:

```env
EVDS_API_KEY=senin_api_anahtarÄ±n
```

`main.py` dosyasÄ±nÄ±n baÅŸÄ±na `load_dotenv()` ekleyin.

#### GitHub Actions OrtamÄ±

1. Repo â†’ **Settings** â†’ **Secrets and variables** â†’ **Actions**
2. **New repository secret** butonuna tÄ±klayÄ±n
3. Bilgileri girin:
   - **Name:** `EVDS_API_KEY`
   - **Value:** TCMB EVDS API anahtarÄ±nÄ±z

---

## ğŸš€ KullanÄ±m

### ğŸ”¹ Tam Ã‡ekim (Ä°lk Kurulum)

Ä°lk kurulum veya tam veri yenileme iÃ§in:

```bash
python main.py
```

**DavranÄ±ÅŸ:**
- 2000 yÄ±lÄ±ndan itibaren tÃ¼m verileri Ã§eker
- CSV dosyasÄ± zaten varsa atlar (skip)
- Yeni seriler iÃ§in CSV oluÅŸturur

### ğŸ”¹ GÃ¼ncelleme Modu

GÃ¼nlÃ¼k gÃ¼ncelleme veya workflow iÃ§in:

```bash
python main.py --update
```

**DavranÄ±ÅŸ:**
- VarsayÄ±lan olarak son 3 gÃ¼nÃ¼ kontrol eder (`UPDATE_DAYS` deÄŸiÅŸkeni ile ayarlanabilir)
- Sadece yeni veri varsa ekler
- Tekrar eden tarihleri otomatik eler
- GÃ¼nlÃ¼k workflow'larda Ã¶nerilen moddur

---

## ğŸ¤– Workflow (Otomasyon)

`.github/workflows/data_update.yml` dosyasÄ± projeyi otomatikleÅŸtirir:

### Manuel Ã‡alÄ±ÅŸtÄ±rma
GitHub â†’ **Actions** sekmesi â†’ **Run workflow** butonu

### Otomatik Zamanlama
Her gece **03:00**'te otomatik Ã§alÄ±ÅŸacak ÅŸekilde ayarlanmÄ±ÅŸtÄ±r.

### Otomatik Commit
Push iÅŸlemi `GITHUB_TOKEN` kimliÄŸiyle otomatik yapÄ±lÄ±r.

> âš ï¸ **UyarÄ±:** Repo boyutu 2GB'Ä± aÅŸarsa GitHub push zorlaÅŸabilir. Gerekirse yalnÄ±zca `data/example/` klasÃ¶rÃ¼nÃ¼ repoda tutun veya Hugging Face Datasets entegrasyonunu kullanÄ±n.

---

## ğŸ—‚ï¸ KlasÃ¶r YapÄ±sÄ±

```
evds-datahub/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ Ana Kategori/
â”‚   â”‚   â””â”€â”€ Alt Kategori/
â”‚   â”‚       â””â”€â”€ Seri AdÄ±.csv
â”‚   â””â”€â”€ ...
â”œâ”€â”€ logs/
â”‚   â””â”€â”€ failed_series.txt
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ data_update.yml
â”œâ”€â”€ main.py
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md
```

### CSV Dosya Ã–rneÄŸi

```csv
Tarih,TP_DK_USD_A_YTL
2025-10-19,32.45
2025-10-20,32.52
2025-10-21,32.58
```

Kolon adlarÄ± otomatik olarak EVDS koduna gÃ¶re oluÅŸturulur (`.` yerine `_` kullanÄ±lÄ±r).

---

## ğŸ§¾ Loglama

TÃ¼m baÅŸarÄ±sÄ±z istekler `logs/failed_series.txt` dosyasÄ±na kaydedilir:

```
[2025-10-21 03:12:45] MENKUL KIYMET Ä°STATÄ°STÄ°KLERÄ° | 1.1.6. Genel YÃ¶netim DÄ±ÅŸÄ±ndaki SektÃ¶rlerce Ä°hraÃ§ Edilen BorÃ§lanma Senetleri | TP.MENKUL.BORC.STOK | ConnectionError veya boÅŸ veri
```

### Hata YÃ¶netimi

- **BaÄŸlantÄ± hatalarÄ±:** Script otomatik olarak birkaÃ§ kez dener (retry)
- **API limiti (429):** 60 saniye bekler ve yeniden dener
- **BaÅŸarÄ±sÄ±z denemeler:** Log dosyasÄ±na kaydedilir

### GÃ¼ncelleme Ã‡Ä±ktÄ± Ã–rneÄŸi

```
ğŸ“¡ GÃœNCELLEME MODU baÅŸlatÄ±lÄ±yor...
ğŸ” Ana Kategori: PÄ°YASA VERÄ°LERÄ° (TCMB) (ID: 1)
  â–ª Alt Kategori: AÃ§Ä±k Piyasa Repo ve Ters Repo Ä°ÅŸlemleri
    â€¢ Seri: (1 GÃœN) AÄŸÄ±rlÄ±klÄ± Ortalama Faiz (TP.API.REP.ORT.G1)
      â†ª GÃ¼ncelleme aralÄ±ÄŸÄ±: 18-10-2025 â†’ 21-10-2025
      ğŸ”„ GÃ¼ncellendi: data/Piyasa Verileri (TCMB)/.../(1 GÃœN) AÄŸÄ±rlÄ±klÄ± Ortalama Faiz.csv (toplam 309 satÄ±r)
```

---

## ğŸ› ï¸ Sorun Giderme

| Hata | AÃ§Ä±klama / Ã‡Ã¶zÃ¼m |
|------|------------------|
| `No such file or directory` | Windows'ta uzun path hatasÄ± olabilir. `LongPathsEnabled=1` ayarÄ±nÄ± aktifleÅŸtirin. |
| `Too Many Requests (429)` | API rate-limit. `SLEEP_BETWEEN_SERIES` deÄŸerini artÄ±rÄ±n (Ã¶r. `1.0` â†’ `2.0`). |
| Push hatasÄ± (kimlik) | Branch korumasÄ±nÄ± veya `GITHUB_TOKEN` eriÅŸimini kontrol edin. |
| `API key hatasÄ±` | `.env` dosyanÄ±zÄ±n doÄŸru konumda olduÄŸundan ve `EVDS_API_KEY` deÄŸerinin geÃ§erli olduÄŸundan emin olun. |

---

## ğŸ“˜ Lisans

Bu proje **MIT LisansÄ±** altÄ±nda daÄŸÄ±tÄ±lmaktadÄ±r.

Bu projeyi kullanÄ±rken **TCMB EVDS** veri servisinin lisans ve kullanÄ±m ÅŸartlarÄ±nÄ± dikkate alÄ±nÄ±z.

---

## ğŸ§  Yazar Notu

**EVDS DataHub**, TCMB EVDS API'sinden alÄ±nan ekonomik serileri otomatik Ã§ekmek, organize etmek ve aÃ§Ä±k biÃ§imde paylaÅŸmak iÃ§in oluÅŸturulmuÅŸtur.

Veri mÃ¼hendisliÄŸi, otomasyon ve aÃ§Ä±k veri altyapÄ±sÄ± Ã¶rneÄŸi olarak tasarlanmÄ±ÅŸtÄ±r.


<div align="center">

**â­ Projeyi beÄŸendiyseniz yÄ±ldÄ±z vermeyi unutmayÄ±n!**

</div>
